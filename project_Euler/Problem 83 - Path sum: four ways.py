"""NOTE: This problem is a significantly more challenging version of Problem 81."""